CREATE DATABASE insurance;
use insurance;

-- CAR TABLE CREATION-- 
CREATE TABLE CAR(
	REG_NO VARCHAR(20),
    MODEL VARCHAR(200),
    CYEAR INT,
    PRIMARY KEY(REG_NO)
    );
-- INSERTING VALUES IN CAR TABLE --
INSERT INTO CAR(REG_NO, MODEL, CYEAR) VALUES 
('KA04Q2301', 'MARUTHI-DX', 2000), 
('KA05P1000', 'FORDICON', 2000), 
('KA03L1234', 'ZEN-VXI', 1999), 
('KA03L9999', 'MARUTH-DX', 2002), 
('KA01P4020', 'INDICA-VX', 2002);

-- PERSON TABLE CREATION -- 
    CREATE TABLE PERSON(
	DRIVER_ID VARCHAR(10),
    PNAME VARCHAR(30),
    ADDRESS VARCHAR(50),
    PRIMARY KEY(DRIVER_ID)
    );
-- INSERTING INTO PERSON TABLE -- 
INSERT INTO PERSON(DRIVER_ID, PNAME, ADDRESS) VALUES
(1111, 'RAMU', 'K.S.LAYOUT'),
(2222, 'JOHN', 'INDIRANAGAR'),
(3333, 'PRIYA', 'JAYANAGAR'),
(4444, 'GOPAL', 'WHITEFIELD'),
(5555, 'LATHA', 'VIJAYANAGAR');
SELECT * FROM PERSON;

-- ACCIDENT TABLE CREATION --
    CREATE TABLE ACCIDENT(
	REPORT_NUMBER INT,
    ADATE DATE,
    LOCATION VARCHAR(30),
    PRIMARY KEY(REPORT_NUMBER)
    );
-- INSERTING INTO ACCIDENT TABLE --
INSERT INTO ACCIDENT(REPORT_NO, ADATE, LOCATION) VALUES
(12, '2002-06-01', 'M G ROAD'),
(200, '2002-12-10', 'DOUBLEROAD'),
(300, '1999-07-23', 'M G ROAD'),
(25000, '2000-06-11', 'RESIDENCY ROAD'),
(26500, '2001-10-16', 'RICHMOND ROAD');

-- OWNS TABLE CREATION --
    CREATE TABLE OWNS(
	DRIVER_ID VARCHAR(20),
    REG_NO VARCHAR(20),
    PRIMARY KEY(DRIVER_ID, REG_NO),
    FOREIGN KEY(DRIVER_ID) REFERENCES PERSON(DRIVER_ID),
    FOREIGN KEY(REG_NO) REFERENCES CAR(REG_NO)
    );
-- INERTING INTO OWNS TABLE --
INSERT INTO OWNS(DRIVER_ID, REG_NO) VALUES
('1111', 'KA04Q2301'), ('1111', 'KA05P1000'),
('2222', 'KA03L1234'), ('3333', 'KA03L9999'), ('4444', 'KA01P4020');

-- PARTICIPATED TABLE CREATION -- 
    CREATE TABLE PARTICIPATED (
	DRIVER_ID VARCHAR(20),
    REG_NO VARCHAR(20),
    REPORT_NO INT,
    DAMAGE_AMT INT,
    FOREIGN KEY(DRIVER_ID) REFERENCES OWNS(DRIVER_ID),
    FOREIGN KEY(REG_NO) REFERENCES OWNS(REG_NO),
    FOREIGN KEY(REPORT_NO) REFERENCES ACCIDENT(REPORT_NUMBER)
    );
-- INSERTING INTO PARTICIPATED TABLE --
INSERT INTO PARTICIPATED(DRIVER_ID, REG_NO, REPORT_NO, DAMAGE_AMT) VALUES
('1111', 'KA04Q2301', 12, 20000), ('2222', 'KA03L1234', 200, 500),
('3333', 'KA03L9999', 300, 10000), ('4444', 'KA01P4020', 25000, 2375), ('1111', 'KA05P1000', 26500, 70000);
SELECT * FROM PARTICIPATED;

-- QUERY 1 --
UPDATE PARTICIPATED
SET DAMAGE_AMT=25000
WHERE REPORT_NO =12 AND REG_NO = 'KA03L9999';

-- QUERY 2 --
SELECT COUNT(*) FROM ACCIDENT
WHERE ADATE LIKE '2002-__-__';

-- QUERY 3 --
SELECT COUNT(A.REPORT_NUMBER)
FROM ACCIDENT A, PARTICIPATED P, CAR C
WHERE A.REPORT_NUMBER = P.REPORT_NO
AND
P.REG_NO = C.REG_NO
AND
C.MODEL= 'MARUTHI-DX';